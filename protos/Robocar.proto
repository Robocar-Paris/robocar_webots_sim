#VRML_SIM R2025a utf8

PROTO Robocar [
  field SFVec3f    translation  0 0.2 0
  field SFRotation rotation     0 0 1 0
  field SFString   name         "Robocar"
  field SFString   controller   "<extern>"
]
{
  Robot {
    translation IS translation
    rotation IS rotation
    name IS name
    children [
      # --- CHASSIS ---
      DEF BODY_SHAPE Transform {
        translation 0 0.15 0
        children [
          Shape {
            appearance PBRAppearance {
              baseColor 0.8 0.5 0.1
              roughness 0.5
              metalness 0.5
            }
            geometry Box {
              size 0.50 0.147 0.25
            }
          }
        ]
      }
      GPS {
        translation 0 0.1 0
        name "gps"
      }
      Compass {
        translation 0 0.1 0
        name "compass"
      }
  
      # --- ROUES ---
      HingeJoint {
        jointParameters HingeJointParameters { axis 0 0 1 anchor 0.18 0.03 0.15 }
        device [ RotationalMotor { name "wheel1" maxVelocity 20 maxTorque 100 } ]
        endPoint Solid {
          name "front left wheel"
          translation 0.18 0.03 0.15
          rotation 0 0 1 0
          contactMaterial "wheel"
          children [
            DEF WHEEL_TRANSFORM Transform {
              rotation 1 0 0 0
              children [
                Shape {
                  appearance PBRAppearance {
                    baseColor 0.1 0.1 0.1
                  } 
                  geometry Cylinder {
                    height 0.05
                    radius 0.05
                  }
                }
              ]
            }
          ]
          boundingObject USE WHEEL_TRANSFORM
          physics Physics { density -1 mass 0.5 }
        }
      }
      
      HingeJoint {
        jointParameters HingeJointParameters { axis 0 0 1 anchor 0.18 0.03 -0.15 }
        device [ RotationalMotor { name "wheel2" maxVelocity 20 maxTorque 100 } ]
        endPoint Solid {
          name "front right wheel"
          translation 0.18 0.03 -0.15
          rotation 0 0 1 0
          contactMaterial "wheel"
          children [ USE WHEEL_TRANSFORM ]
          boundingObject USE WHEEL_TRANSFORM
          physics Physics { density -1 mass 0.5 }
        }
      } 
  
      HingeJoint {
        jointParameters HingeJointParameters { axis 0 0 1 anchor -0.18 0.03 0.15 }
        device [ RotationalMotor { name "wheel3" maxVelocity 20 maxTorque 100 } ]
        endPoint Solid {
          name "rear left wheel"
          translation -0.18 0.03 0.15
          rotation 0 0 1 0
          contactMaterial "wheel"
          children [ USE WHEEL_TRANSFORM ]
          boundingObject USE WHEEL_TRANSFORM
          physics Physics { density -1 mass 0.5 }
        }
      }

      HingeJoint {
        jointParameters HingeJointParameters { axis 0 0 1 anchor -0.18 0.03 -0.15 }
        device [ RotationalMotor { name "wheel4" maxVelocity 20 maxTorque 100 } ]
        endPoint Solid {
          name "rear right wheel"
          translation -0.18 0.03 -0.15
          rotation 0 0 1 0
          contactMaterial "wheel"
          children [ USE WHEEL_TRANSFORM ]
          boundingObject USE WHEEL_TRANSFORM
          physics Physics { density -1 mass 0.5 }
        }
      }
    ]
  
    # PHYSIQUE DU CHASSIS
    boundingObject USE BODY_SHAPE
    physics Physics {
      density -1
      mass 8.0
      centerOfMass [0 0.05 0]
    }
    
    controller IS controller
  }
}